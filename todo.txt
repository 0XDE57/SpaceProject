***the vision***
In space you fly around to explore planets and star systems, and combat other ships.
For Combat/fighting, my vision is to have some elements of reactive fighter style like smash bros
where you can attack, dodge and use shield. Maybe you can upgrade your ship or swap out components
for different abilities.

In space there will be asteroids floating around. Kinda like the original arcade style asteroids. Just
arbitrary convex polygons. But when they break ideally they would shatter in a way that all the pieces
that break off can make up the original object. To achieve this; voronoi diagrams! A cool property of voronoi
diagrams is that the polygons it creates are always convex by nature. When an asteroid is shot by player,
create a set of random points (perhaps concentrated where the bullet hits) within the asteroids polygon.
From those points make a voronoi diagram within the original polygon, then break up the asteroid into the resulting pieces.
Those pieces can also be hit and broken down further with the same process. Until a certain threshold of
smallness where we actually destroy the object because there's no point in breaking it own further.
Upon destruction, chance to drop items/resources for the player to pick up.
Maybe the asteroid contains resources or items which can be used by the player.

Asteroids could spawn as belts around stars. Or a random asteroid field floating through space.
A set of asteroids in a group, for the player to mine/destroy.

Players can land on planets. Planets are generated by a tile-able noise so that the edges of the map
meet. The goal is to have a finite 2D map where you can walk continuously in one direction and eventually
come back around to where you started. This is achieved via OpenSimplexNoise, a bit of trig and modulus
magic for rendering! But there are some other technical challenges this presents that I have not yet
addressed. see https://simonschreibt.de/gat/1nsane-carpet-2-repetitive-worlds/

On the planet the player will be able to build their base. Mine for resources. Build/upgrade their ship.
Currently space is fairly empty. Worlds are very empty. Just test objects while I flesh out my ideas
and prototype systems.


::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
It's half in notes, half in my head, and half in code.

***architecture***
Uses an ECS. If you are unfamiliar with the concept of an Entity Component System, start here:
    https://github.com/libgdx/ashley/wiki/Framework-overview
For consistency, components are pure data, no implementation. This may change in future.

Systems are dynamically loaded and unloaded per context. Space and World can have different systems.
    eg: don't need an orbit system when on a planet.
Mobile and Desktop can have different systems.
    eg: don't need to render touch control on desktop
See SystemsConfig for defining system priories and properties.


One goal is to have everything highly configurable. (and perhaps I have gone too far in this direction at the cost of complexity?)
Data Directory (...\SpaceProject\android\assets)
    \config:
        plain text json files that define all values for game. these files will be written on first run of the game.
        if no config exists, default is loaded and written to disk. if config exists on disk, it is loaded.
        [default always loaded when debugDevForceLoadDefault = true]
            SystemsConfig: define system loading priorities and properties.
                priority: order of execution is important for game loop logic and rendering pipeline.
                haltOnGamePause: if true, system stops processing when game is paused.
                loadInSpace: if true, system will be loaded when player is in space.
                loadInWorld: if true, system will be loaded when player is on a planet.
                loadOnDesktop: if true, will be loaded on desktop platform.
                loadOnMobile: if true, will be loaded on iOS or Android platform.
            EngineConfig: define physics and rendering constants
            KeyConfig: define input keycodes
            EntityConfig: define generation parameters for entities
            CelestialConfig: defines star system generation rules
            WorldConfig: define terrain generation parameters (in progress)
            DebugConfig: defines settings like show debug rendering
            MinimapConfig: define colors and behaviors for minimap
            UIConfig: define ui element colors and positions
    \fonts: fonts for UI
        .tff   : True Type Fonts
    \shaders: GLSL shader files (name convention: reference GLSL compiler extensions)

        .vert  : vertex shader
        .tesc  : tessellation control shader
        .tese  : tessellation evaluation shader
        .geom  : geometry shader
        .frag  : fragment shader
        .comp  : compute shader
        .mesh  : mesh shader
        .task  : task shader
        .rgen  : ray generation shader
        .rint  : ray intersection shader
        .rahit : ray any hit shader
        .rchit : ray closest hit shader
        .rmiss : ray miss shader
        .rcall : ray callable shader
        .glsl  : .vert.glsl, .tesc.glsl, ..., .comp.glsl compound suffixes
        .hlsl  : .vert.hlsl, .tesc.hlsl, ..., .comp.hlsl compound suffixes

    \sounds: (todo)
        each sound effect gets it's own folder.
            if no sound in folder, dont play
            if one sound in folder, play that
            if multiple sound in folder, play random
            allow user configurable chance? what about effects/volume? NO! this is overkill for now but just an idea. Keep it simple...
        potential structure / implementation might look like
            music
                track a
                track b
            effects
                effect a
                    effect1.wav
                    effect2.wav
                    effect3.wav
                effect b
                effect c
    \save: (todo) serialization
        https://github.com/libgdx/libgdx/wiki/Saved-game-serialization


Space Background Rendering
	Simple but effective: 4 parallax layers
		stars close
		stars far
		stars far
		noise far
	Background color is set based on camera positioning.
		Just some combinations and ratios of red, blue and green that I played around with until it looked nice.

Noise Generation
	Noise is heavy to generate at runtime so it's done in background threads.
	Once generated, it's picked up by SpaceLoadingSystem who then creates a texture from the noise.
	You can specify how many simultaneous threads you would like to allow in EngineConfig.
	Todo: save textures/noise so it's only generated the first time. Load from disk.
	For dev purposes, just generate ad-hoc for now.
    [!] NOTE: cannot generate textures in another thread due to glContext...
        https://github.com/libgdx/libgdx/wiki/Threading
        https://www.opengl.org/wiki/OpenGL_and_multithreading
        We can however generate noise for the textures on a separate thread and then feed that to the rendering thread.

Screen transition logic/stages overview
One of the trickier parts of the engine. Animation states for transition, and dynamic system loading/unloading.
When animation hits transition state, it calls the system loader and loads/unloads relevant systems based on SystemsConfig

	Transition action (key press, virtual button on mobile)
	ControlSystem()
		if in space
			landOnPlanet()
				find planet
				add ScreenTransitionComponent -> anim stage = shrink
			takeOffPlanet()
				add ScreenTransitionComponent -> anim stage = transition

	ScreenTransitionSystem()
		landOnPlanet:
			shrink: shrink ship sprite to give illusion of landing
			zoomIn: zoom in camera
			screenEffectFadeIn: fade screen to white
			transition: trigger GameScreen to switch to planet. load and unload relevant systems.
			load: (todo: ensure planet map loaded before allowing play)
			screenEffectFadeOut: fade white back to screen
			pause: brief pause for effect
			exit: player get out of ship
			end: remove transition component
		takeOffPlanet:
			screenEffectFadeIn: fade screen to white
			transition: trigger GameScreen to switch to planet. load and unload relevant systems.
			sync: ensure find planet landed on is loaded (based on seed), ensure found and texture loaded before allowing play
			zoomOut: zoom camera from 0 to normal
			grow: grow ship sprite from 0 to give illusion of taking off planet
			end: remove transition component


Scale of the universe.
Currently somewhat arbitrary. Just selected values that make sense at the time and feel ok.
I originally wanted to play with n-body physics and have an "infinite" universe....hahahaha NO! Focus!
So while in space, we are in a finite galaxy. Points of interest are generated relative to 0,0.
Go too far into the void, and enjoy broken rendering and physics, courtesy of floating point arithmetic rounding!
Todo: Need to make a more standard definition for everything:
    sprites and unit: how big should a ship or player be in relation to the universe / planets?
    planets: how big should a planet be?
    distances between planets: how long should the player spend traveling between systems and planets and stars?
    Values need to be chosen that make sense for gameplay. Considering combat, base building, interstellar travel.
    Should optimize feel for spaceship combat as that will be a large part of gameplay.


AI: currently primitive placeholder systems to flesh out ideas.
They can't aim properly, need to predict where player will be. Lead target.
And much more....problems for later.


::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
***the plan***: make combat fun. make flight and movement fun, and look a little better.
focus! i keep jumping between ideas and features and never finish anything
Spaceship combat will be a core part of gameplay. So lets focus on cleaning that up first.

Legend:
    [   ] = not started
    [...] = in progress
    [ x ] = complete
    [ ? ] = question
    [ ! ] = notes
    [ * ] = exceptions


[ ] terrible BUG! lerping camera movement is giving some jittering in the rendering when vsync on.
        less visible when vsync off. not visible when lockedOn.
        look into interpolating physics, and investigate floating point errors

[...] BUG! start game, leave to main menu, return to game: planets do not load
    [x] clean up, dispose and unload systems properly when return to main menu
    [ ] things will load now, but there seems to be a strange delay...
        -start game, leave to main menu, start game again = empty until move around for a bit then loads
        I believe this is to do with the noise threads shutting down?

[...] needs frame of reference to judge speed and direction since parallax is so deep
    [ ] floaty dust particles at same depth as player to help visualize movement/speed
        perhaps play with lod, different layers based on zoom
        maybe with a very slow wander
    [ ] space debri, mostly inconsequential small irregular bodies
    [x] fog layer (particles, or white noise parallax at 1.0?)
        [ ] could have different layers that fade in and out at different depths when zoom out
        [ ] fog layer could use some more octaves. possible shader can just render another layer on top
            with some movement and multiply the layers together
        [?] what about a basic noise shader rendered to a quad on a layer above player?

[x] add basic asteroids (arbitrary poly)
    [x] spec spawner for asteroid.
    [...] belt - ring around barycenter component
        [ ] orbit with flocking / group mechanic
    [ ] unload asteroids when system unloaded
    [ ] field - randomly spawn while in space
    [...] begin make asteroid
        see: AsteroidAnim.java for prototyped polygon and rendering
        [...] attach box2D poly to match asteroid poly
            [ ] fix center of gravity
        [x] take damage when hit by shots
    [...] break into smaller asteroids
        [ ] voronoi shatter, for destructible asteroids.
            (and world generation can be used for tectonic plates / countries / biomes)
            https://www.badlogicgames.com/forum/viewtopic.php?f=11&t=22784 (my old thread)
            https://github.com/mjholtzem/Unity-2D-Destruction
        	http://www.alanzucconi.com/2015/02/24/to-voronoi-and-beyond/
        	https://stackoverflow.com/questions/20104779/libgdx-create-texture-from-overlay-using-pixmap
        	https://pvigier.github.io/2018/11/18/fortune-algorithm-details.html
            http://www-cs-students.stanford.edu/~amitp/game-programming/polygon-map-generation/
            https://leatherbee.org/index.php/2018/10/06/terrain-generation-3-voronoi-diagrams/
            texture and create child bodies from parent:
            https://www.emanueleferonato.com/2012/01/17/create-real-explosions-with-box2d-adding-textures/
            https://www.emanueleferonato.com/2012/03/05/breaking-objects-with-box2d-the-realistic-way/
            https://thebookofshaders.com/12/

[ ] JUICE!
    https://www.youtube.com/watch?v=Fy0aCDmgnxg
    https://www.youtube.com/watch?v=tu-Qe66AvtY
    [x] lag camera behind movement a little for visual effect, especially when dodging for more visual impact

    [x] change cursor to a crosshair sprite
    [...] camera allow cursor to "extend view": pushing cursor to edge of screen pulls camera position at a point between player and mouse
    [...] camera: combat camera
        manually zooming in an out when fighting is a bit clunky and jarring.
        [x] implement an auto lock on camera which will adjust the zoom to include both the player
            and the enemy within frame
        [ ] always keep player in frame no matter what
        [ ] tuning: when entities too far apart or too out of frame, return to focusing on player
        [ ] tuning: lerp between locked on state and player focus
        [ ] consider multiple enemies, 3 on screen? include all will make zoom far and less focused, so probably some sort of
            dynamic focus, maybe who gets shot last has focus? todo: study cam mechanics for smashbros / project m style combat
            thresholds for how close to focus near the edge
        [?] still allow manual override with scroll, with perhaps a timer to focus back in, or when a new enemy joins
    [ ] while im no artist, i think picking a color palate might make it look a world and ui a little more consistent
        http://devmag.org.za/2012/07/29/how-to-choose-colours-procedurally-algorithms/
        [ ] the space ships need more contrast from space background
    [ ] box2d lights https://github.com/libgdx/box2dlights
        [ ] engine fire can be a light source
        [ ] shield can be a light source
        [ ] player eyes facing forward cone light
        [ ] lava on planets can be a light source
    [...] better star rendering
        [ ] smooth out image
            could extend the source star radius on texture (or simply full rectangle), then simply set the alpha drop off in the shader
        [ ] could shift the noise vertically and horizontally
        [ ] shift should go continually outward, not roll back inward (sinewave)
        [ ] better colors
            [ ] give stars random temperature between: 1000 - 50,000 Kelvin
                "Stars vary in surface temperature from about 2,000 to 40,000 kelvin"
                Harvard spectral classification
                O	≥ 33,000 K 	        blue
                B 	10,000–33,000 K 	blue white
                A 	7,500–10,000 K 	    white
                F 	6,000–7,500 K 	    yellow white
                G 	5,200–6,000 K 	    yellow
                K 	3,700–5,200 K 	    orange
                M 	2,000–3,700 K 	    red
                R 	1,300–2,000 K 	    red
                N 	1,300–2,000 K 	    red
                S 	1,300–2,000 K 	    red
                https://simple.wikipedia.org/wiki/Stellar_classification
            [x] Make function to convert temperature to color
                Wien's Law: tells us that objects of different temperatures emit spectra with peaks at different wavelengths.
                    Hotter things - peak at shorter wavelengths - bluer
                    Cooler things - peak at longer wavelengths - redder
            [ ] luminosity?
        [ ] could add more noise layers: octaves
        [ ] needs flares!!!
            [ ] some sort of texture / shader to make firery splines
            [ ] outward firing firery particles
        [ ] varying brightness, twinkle by increasing decreasing brightness pseudo-random sine wave, or rather 1d noise
        [ ] lighting. sun as source of light lighting up planets and ships around it
            [ ] apply shadow on side of planets not facing star
                [ ] could even do eclipse if another planet / moon in between star
            [ ] apply light source on 3D models would make 3D barrel roll rotation more clear with shadowing
        it's currently static just like planets, but I want it to shift the z, exactly like the title screen background
            com.spaceproject.screens.animations.NoiseAnim
        could be done on gpu even:
            https://www.shadertoy.com/view/XscGzl
    [ ] better planet rendering
        inspiration: https://github.com/yurkth/astraea
        [ ] nearby stars can be light sources, shade side not facing star
    [ ] SHADERS!!!
        [ ] when entity hit, sprite needs to flash red or white -> shader
        [?] 2D outline shader for ships and mouse over objects
            http://www.allpiper.com/2d-selection-outline-shader-in-libgdx/
            https://www.youtube.com/watch?v=1yuYUVFUOvI&list=PLqpawGIg6Qj5CvjOaCbB536z862XhjPQi&index=17
    	https://github.com/mattdesl/lwjgl-basics/wiki/Shaders
    	https://github.com/mattdesl/lwjgl-basics/wiki
    	https://www.shadertoy.com/view/XscGzl <--use for stars
    	http://www.alanzucconi.com/2015/07/01/vertex-and-fragment-shaders-in-unity3d/
    	http://www.alanzucconi.com/2016/01/27/arrays-shaders-heatmaps-in-unity3d/
    	http://wwwtyro.net/2016/10/22/2D-space-scene-procgen.html
    	https://thebookofshaders.com/


[...] rendering system
    [ ] decouple HUD from stage -> move scene2D stage out of HUD into own system
    [x] fix space parallax system rendering
        [x] background layer stars are just white currently
            give them a random temperature then convert wavelength to rgb: Black body radiation!
        [x] i think it needs to be rendered with a separate camera / viewport as to not zoom out with main camera
            the background space image needs to be "very far away", give the illusion.
        [ ] generating pixmaps on the fly is slow.
        [?] option 2: replace with shader?
            maybe something like this:
            https://www.shadertoy.com/view/ltXSDN
            https://www.shadertoy.com/view/ldKGDd
            https://gamedev.stackexchange.com/questions/146098/2d-parallax-scrolling-through-glsl-shader
            https://badlogicgames.com/forum/viewtopic.php?f=11&t=11419
            or something like this:
            https://wwwtyro.github.io/space-2d/
            https://github.com/wwwtyro/space-2d
            [...] POC star shader with fullscreen quad in separate project
                https://github.com/0XDE57/gdx-shadertoy
                    helpful for porting shadertoys to libgdx:
                                    https://gamedev.stackexchange.com/questions/186477/why-dont-shadertoy-shaders-work-with-libgdx
                https://www.youtube.com/watch?v=rvDo9LvfoVE
                [OUT_OF_SCOPE] Bonus would be reallly cool but overkill would be to feed audio track into
                the shader so it can react to the music. apply FFT -> visualizer. pulse stars to the beat?
        [x] background space color fade to black when zoom out (temporary until better space background approach is implemented)
        [x] experiment: can we make the background tiles just not zoom out? use a different batch perhaps?
    [...] fix render priority (z-order)
          [X] moved into separate variable
          [x] define proper heights for importance as current values are somewhat arbitrary
          [?] this is now a bit more complex, as there is a mix of 2d sprites and 3d renderables, that are rendered in separate batches (2d then 3d overlay).
              to mix the z between them may require multiple batch passes, or migrating to 3d, also shaperenderer on top of that...
              custom shape renderer?
              if we are doing too much batch flushing could use (bonus if could do outlined shapes, perhaps a job for a shader instead?):
              https://github.com/earlygrey/shapedrawer

[...] respawn
    [x] for now, just place back at origin 0, 0
    [ ] move into own system
    [ ] how to handle death? start on planet back at base? start at a space station?
        [?] could have a "home planet" and just spawn from there like transitionsystem takeoff
        [?] base space station that has its own orbit around either planet or star. dock to space station
    [ ] notify AI that are stuck attacking nothing and should return to dumbwander or previous task

[...] shield
    [...] if collide with bullet, shrink/destroy shield
    [x] fix radius is not consistent. rotation of body affects size of shield. don't trust calculateBoundingBox()?
    [x] shield growth overrides and cancels charge cannon
    [ ] grow/shrink body with shield. looks like cant resize bodies in box2d? destroy and recreate each frame seems inefficient likely
    [ ] if collide with another body with significant difference in velocity
        and if other has HealthComponent, do damage using velocity as damage factor
        [ ] shield dash bash? high impulse forward, then activate shield to ram other objects and do damage to them
    [x] bug not render on planet
    [ ] graphics: rotate shield polygon, possibly a shader to make edges glow
    [x] should be unavailable during hyper drive
    [ ] should not activate during screen transition
    [ ] needs control for mobile

[...] barrel roll
    [...] adjust feel, impulse, tuning
        [ ] boost flame should be bigger than regular, maybe additional particles?
        [ ] forward + side boost should make diagonal impulse 45 between engines
    [x] change engine particle effect color when dodging / boosting
        [ ] should only change for boosted engine, not all active, unless all boost
        [?] should boost forward and sideways add impulse from both axis
            at reduced power shared between? = 45 degree angle impulse
    [x] apply forward force similar to dash with same impulse power
        [ ] should just go forward when alter hit, no need for alter. to be more coherent with dash.
            rename alter as boost?
    [?] allow roll on other axis? could allow for front/backflips. also, could use other roll parameter for animation
    [x] when hit by projectile, roll the body a bit, then the roll system will stabilize it back
        for impact feel
    [x] should not activate while using shield
        [?] should allow while shield is discharging? might feel more responsive
    [x] should not activate while hyperdrive active
    [ ] should not activate during screen transition
    [ ] needs control for mobile

[x] character dash
    [ ] some sort of visual elements to show speed / motion: eg dust cloud at feet or whooshy lines

[...] grow cannon
    [x] BUG: charge cannon should always fire when trying to fire instead of waiting for minimum charge (cooldown between shots instead of build up until can shoot)
    [x] BUG: when entity is killed/removed during charge, charge cannon and particle remain instead of being removed
    [ ] should be circle instead of rectangle?
    [ ] should change color when maxed
    [ ] lock on nearest target when maxed
        [ ] visual in hudsystem for tracked entity
        [ ] predict angle to aim to hit based on pos and velocity
        [ ] steering behavior AI?
    [?] could perhaps shrink "lose energy" over time and destroy self when smaller than threshold
        only maintains size when fully charged to max
    [ ] AI doesn't know to release grow cannon, only tuned for regular cannon
    [ ] should not fire during screen transition

[ ] hyper drive
    [x] hyperdrive should be hold key to charge up instead of instant activate
    [ ] different bigger particle effect for when active
        [x] different color particle effect for fire. different from normal and boost. maybe purple or green?
    [ ] blur passing by background stars as if not clearing screen between frames: streaks
    [ ] tune feel: give more impact
        [ ] maybe some screen shake during
        [ ] potential for playing with some shaders

[...] particle effects!
    https://github.com/rockbite/talos
    [ ] BUG: broken engine effects applying to other ships when land on planet
        [ ] BUG: related, when take off again particles are wack!
    [x] projectile tails - simple rect or circle particle trailing bullets
        [ ] apply to other cannon
    [x] particles need to render on top of planets. planets should be first rendered (low depth) in the render pipeline
    [x] particlesystem and emitter components
    [x] rendering is lagging behind camera "drift bug" -> refactor rendering/system order.
        looks fixed when vsync off
        [x] split into update and render? fixed!
    [x] absorb effect when charging charge cannon
        fixed! solution -> attached: true in *.particle
            - Options -
            attached: true
        [x] should not drift when rotating
        [x] should not drift when moving (absorb, locked to charge itself, not relative to ship movement?)
            particle should chase bullet instead of moving towards spawn origin which is no longer the bullets location
    [ ] alternate engine particle effect when hyperdrive active
    [ ] absorb effect when charging shield
    [ ] charge burst effect when bullet destroyed (absorb reversed)
    [ ] shield burst effect when hit by bullet and shield destroyed
    [ ] explosion effect on ship destroy
    [ ] some particles on projectile destroyed/removed
    [ ] scale engine particle emission or velocity by movement multiplier
        - Emission -
        lowMin: 0.0
        lowMax: 0.0
        highMin: 250.0
        highMax: 250.0
        relative: false

[ ] controls and input
    [...] need a better slow down / stop. perhaps a reverse force, and point side engines forward 45
        [x] this control should also exit hyper drive
        [ ] how does this feel with controller? needs moveBack control
    [x] basic controller input
        [?] should separate look from movemwent? meaning movement left stick, aim/look right stick
            might make sense for on foot character (could separate look and movement on MnK too)
            this would displace the camera zoom control. we could let it modify camera with a modifier? eg: d-pad left + right stick
            would probably make mobile control more difficult (two virtual sticks)
        [ ] scene2d stage (main menu and pause menu) needs to support controller input. multiplexer?
            https://github.com/MrStahlfelge/gdx-controllerutils/wiki/Button-operable-Scene2d
        [ ] also keyboard navigation focusable items
        [x] tested with xbox 360 wired and ps4 controller over usb
        [x] allow hot-plugging
        [x] crashes title screen after return to menu from game, looks like systems still loaded (unhook listeners?)
         cant repro, seems fixed. update: still crashes!!! update: fixed again.
        [x] basic Xbox 360 support
            [x] not detecting DPAD buttons
            [x] double tap right left bumpers for barrel roll
            [x] right stick camera control, click to reset
        [x] move to getMapping() but seems im on an older lib?
            https://github.com/MrStahlfelge/gdx-controllerutils/wiki/Configurable-Game-Controller-Mappings
            https://github.com/libgdx/gdx-controllers/wiki/Migrate-from-v1
        [?] right trigger boost, similar to roll impulse?
        [ ] left trigger for break / slow down
    [ ] keyboard navigation for menus
            [...] debug menu
            [...] main menu
                [x] hotkeys
                [ ] navigation and selection
            [ ] title menu
    [ ] mobile
        [ ] if player bounds overlap vehicle, show enter button on touchUI/hud
        [ ] if in vehicle show exit button (if can get out? must be over platform/spacestation? jetpack?)
        [ ] pinch-pull to zoom in-out on touch
        [ ] test touchUI on different screen sizes/resolutions
        [ ] set engine speed max to multiplier on android?
        [ ] hyperdrive needs control for mobile
        [ ] dodge/barrelroll needs control for mobile
        http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/input/GestureDetector.html
        http://tutorial-libgdx-android.blogspot.com/2014/02/inputs-handling-1st-part.html
    [?] shield bash?: double tap forward(or direction) and hold to rush, then shield do shield action [B] within time window of dash, and hold
    [?] land take off could be hold instead of instant
    [ ] landing should be easier, when in range of planet (larger radius than planet itself)
        [ ] should not be relying on debug instant stop control, breaking needs to be better / smoother
        - additional animation step, autopilot. instead of instant stop
            - calculate () required angle and velocity to aim at center of planet
            - automatically apply correct force to steer efficiently/accurately
            - face opposite of velocity (aim for planet)
            - hard engine blast to slow down fast, calculate relative velocity to apply correct force
            -
        - ensure AI can't overshoot
        https://github.com/libgdx/gdx-ai/wiki/Steering-Behaviors#arrive
    [ ] getting into ship sometimes a little clunky, switch from distance check to sensor
        add sensor to player
            if contact has ship component, get in.
        could also hand generic interactions if contact has interactable component, do whatever interact action
        collision callback can also solve mobile ui for vehicle button:
            BeginContact:vehicleButton.enable()
            EndContact:vehicleButton.disable()
        http://www.iforce2d.net/b2dtut/sensors

[ ] AI
    [ ] lead shot, projectile prediction

[ ] sound: there is no sound in the vacuum of space, therefore music sound effects are not required!
    jk, sound will eventually exist
        https://github.com/libgdx/libgdx/wiki/Audio
    Apparently audio on android sucks?
        https://github.com/barsoosayque/libgdx-oboe
    More advanced audio:
        https://github.com/Hangman/TuningFork
        https://github.com/rafaskb/Parrot
        https://github.com/rafaskb/Boom

[...] physics and movement
    [x] move to box2d
        [x] move logic to new physics
        [...] figure out scales and values that make sense and work with the b2d engine (consider scale of space)
            [ ] create unit/body scale helper
        [ ] move to filters?
            http://www.iforce2d.net/b2dtut/collision-filtering
            https://gamefromscratch.com/libgdx-libgdx-tutorial-13-physics-with-box2d-part-4-controlling-collisions-using-filters/
            https://www.youtube.com/watch?v=IIZ7XI6L7IA
    [x] fixed time step (necessary for multiplayer?)
        [ ] interpolation
        https://github.com/libgdx/ashley/pull/215
        https://github.com/libgdx/ashley/pull/216
        https://gafferongames.com/post/fix_your_timestep/
        http://gameprogrammingpatterns.com/game-loop.html
        http://www.koonsolo.com/news/dewitters-gameloop/
    [?] how to better handle collision system telling other systems what to do?
        https://gamedev.stackexchange.com/questions/23834/how-to-properly-implement-message-handling-in-a-component-based-entity-system
    [?] note to self, was my old physics broken due to #5048?
        I dropped my physics because the impulse was so weird, i did infact use Intersector.overlapConvexPolygons() in CollisionSystem.java.overlaps()
        https://github.com/0XDE57/SpaceProject/blob/1a764f9aaa405ba18341ad35c2a75b4ecd02a535/core/src/com/spaceproject/systems/CollisionSystem.java
        [ ] todo: confirm that im not crazy? because i spent a lot of time moving to box2d if this is true lol.... thats ok.

[...] screen transition between world and space
    [ ] ready / sync / load state. should all be in transition system?
        still a little coupled, but working reliably now
        [ ] WorldRenderingSystem shouldn't be responsible for loading map: loadMap().
    [ ] landing animation should center camera focus on planet rather than player
    [ ] better take off animation
        [ ] should have ship leave ground camera stays put, create a shadow sprite underneath for depth
        [ ] ship can fly off screen, camera stays put, zoom out.
    [?] should not be loading system near origin, position needs to shift to last known planet BEFORE SpaceLoadingSystem picks it up
        [SystemLoader] systems loaded in 1ms
        [SpaceLoadingSystem] Planetary System: (1000.0, 1000.0) Objects: 8
        [ScreenTransitionSystem] Animation Stage: sync for Entity@7440577b
        Forget the context of this bug, it is happening when leaving planet far from origin?
    [x] finish transition animation, should have screen effect for polish and to hide loading/level change. goal feel a little more seamless
        (fade to white/pixelate shader during landing, load map (can wait here for a second if not finished generating, when generations finished start white then fade normal, continue)
    [x] bug: had an instance where take off rogue planet ended up with no ship and seemingly wrong co'ords
        see: ScreenTransitionSystem.syncLoadPosition()
    [x] bug: landing and take off unreliable for systems away from origin, location not saved / set when land
        cannot find seed
        cannot find seed
        cannot find seed
        this bug is driving me insane, but there's still some transition and loading details to work out
        fixed!...but keep and eye on it.


[OUT_OF_SCOPE] "Persistence Engine" what to do with rest of universe when on a planet? or stuff going on on planets when we are in space?
    genericize and make work land and take off work for AI, system doesn't support non-player world switching
    dumb loop where AI lands on planet, kept in some kind of background
    processing state/alt engine, wait a second then take off to test all is working correctly
    background engine meant to be low processing effort (eg: ultra dumbed down AI or simulations, no rendering, no physics, just states and events) to keep track of important entities
    and states between space and worlds. eg: give entity important flag component to keep relevant, if dont have flag dont care and remove when switch
    will be useful for persistence, AI and story type events.
    //Example scenario:
    //    you are on planet, you attack an AI, Ai comes after you. But you leave in your ship.
    //    then AI gets TimedPersistenceComponent and will remain on planet for 5 minutes waiting for you, because angry!
    //    maybe they will come after you. this could be very simple. we can fake intelligence in a background system in persistence engine
    //
    //    Think similar to skyrim, you attack someone in a house and leave they follow you out.
    eg:
    Engine persistenceEngine.
    if (player switch screen) {
        //move important entities from main to background processing
        for each entity in mainEngine {
            if (entity has PersistenceComponent) {
                persistenceEngine.Add(entity);
            }
        }
        //move relevant entity from background processing to main
        for each entity in persistenceEngine {
            if (entity has PersistenceComponent) {
                if (is persistence relevant to new context) {
                    //example relevance:
                    //player in space, important entity on planet
                    //if land on planet with important entity, load into actual engine
                    mainEngine.Add(entity);
                    //could be more nuanced, like perhaps entity is only loaded when event triggers it
                    //or specific location on planet. dunno till start implementing.
                    //possibly have multiple engines handling contexts? (thats dumb and overkill. keep it simple.)
                }
            }
        }
    }
    if (AI switch screen) {
        //similar thing to above
        //if relevant load it, else keep in background

        //if not important, remove from engine, forget about existence
    }


[...] fix texture / map loading
    [ ] save load noise so it doesnt have to be generated
    [ ] clean up star save/load
    [!] bug: when play with generation settings in TestNoiseScreen, seems to effect map/tile generation in game
        ! actually for now this is a convenient bug for testing


[ ] fix floating point errors in deep space caused by large world coordinates and small frame times is affecting movement physics: epsilon / truncating errors
    https://randomascii.wordpress.com/2012/02/13/dont-store-that-in-a-float/
    https://www.youtube.com/watch?v=mXTxQko-JH0&t=4m18s

[ ] devmode and play mode
    [ ] DevMode
        -dont load save files
        -hardcoded seed
        -forced test entities
        -forced close star system
    [ ] PlayMode
        -load save
        -random seed
        -no hardcoded entities. entities should come from spawning systems instead
    [ ] new CombatTest debug screen for prototyping combat and movement mechanics and feel
        [ ] player vs AI
        [ ] AI vs AI


[...] Space Ship
    [...] COMBAT
        [...] 3D roll animation for dodge / barrel roll
                [...] scale bounding box during rotation
                [x] adjust feel, it doesn't quite feel very dodgy, maybe try lagging the camera behind the roll
                [ ] clean up: should move values to config
                [ ] clean up: optimize rendering -> ModelCache
                [ ] mobile/touch UI way of activating dodge, a swipe on the joystick may be intuitive
        [ ] bullets should come from a gun rather than magically from ship
        [ ] weapon types
            [x] basic cannon
            [x] grow cannon shoot circles/rectangles with radius relative to damage "weight" of projectile (damage = size * velocity * typeMultiplier)?
            [OUT_OF_SCOPE] L cannon, touhou style multiple bullet cannon
            [OUT_OF_SCOPE] Laser cannon
    [ ] engine mode:
            [x] local/combat (slow, for interacting with object near, landing planets, fighting)
                defined as max 60. over goes to cruise mode
            [...] travel/cruise (medium, for navigating within a system, planet to planet, avoid/escape, faster travel)
                defined as 60 - 120. 120 is box2d engine max with current physics settings.
                use of shield or weapon should auto return you to combat speed
            [x] hyper/warp   (fast, warp to other systems, can't turn, can't fight)
                activated by [T]

    [OUT_OF_SCOPE] ship generation
        [ ] fix ship edges to use entire width of texture
	    [...] wings
	    [ ] engines
	    [ ] weapons
	    [ ] details: eg: lines, another layer on top for depth/windshield type thing, different stuff on underside of sprite
	    [ ] generation styles and classes, perhaps come up with some kind of classes of ships (cargo, highspeed traveler, tank/war machine, passenger, personal, commercial...)
	    inspiration:
            http://davebollinger.org/works/pixelspaceships/
            https://www.reddit.com/r/gamedev/comments/2tavse/2d_procedural_spaceship_generator/
        [ ? ] do we give up on proc gen and modular ships and go with something like:
            https://livingtheindie.itch.io/pixel-art-spaceships-for-shmup

[OUT_OF_SCOPE] Planetary Base Building
    Player can spawn on, or land on a  planet. And walk around.
    Give player character tools hammer / pickaxe for mining.
    Ore / minerals / materials will be algorithmically dispersed throughout the planet.
        - rock
        - iron
        - steel
        - silver
        - gold
        - diamonds
        - etc, added as needed
    Player can use materials for building.
    Can also be used for trading at space stations -> sell gold / diamonds for currency -> buy ships / upgrades.
    Player tools: (for now player always has slege and pickaxe by default, can't drop, can use with click, switch equipped with hotkey)
        sledge hammer   : breaking rock, destruction, attack(hit enemy, do damage, knockback force),
        pickaxe         : mining minerals
        sword           : damage
    I really don't want to do a complex crafting system, keep it simple.
    For now, the only items should be raw materials themselves.
        eg: i dont want to have to build a wall item with rock and steel,
            i should just be able to place a wall if i have the raw materials cost
            i don't want to hold onto a wall item.
    - get rock / ore -> turn into items / entities
        - walls (cost: rock, steel)
            - blocks bullets, takes little to no damage from player
        - landing pad (cost: rock)
            - lays down a gravelly / paved sort of pad, and a places a flag(no cost) (which shows wind direction)
            - when landing on planet, you will land at your home base pad (or last used pad if multiple)
            - use: typically would make this the first step of picking your base location, then build walls around it
        - gates (cost: rock, steel
            - (walls with sliding block)
            - can be manually open closed by player, (box2D sensor)
            - powered component, open close requires power source
        - roads: (cost: rock)
            - gravelly paved path to walk / drive on
            - probably just cosmetic, could perhaps have physics implications for vehicle
        - bridge: to cross river
        - terminal
            - I/O cables and circuitry / scripting possibilities...way out of scope.

[...] planet generation
    [ ] research planet attributes //size, temperature, pressure, atmosphere/elements(https://en.wikipedia.org/wiki/Astronomical_spectroscopy)...etc
        https://en.wikipedia.org/wiki/Circumstellar_habitable_zone
        [ ] add temperature variable to planet determined by distance from star
        [ ] for now simple linear, close to planet = hot, far from planet = cold
        [ ] if want more advanced, have star temperature based of distance from galaxy center
            then that would also affect star temperature.
            for inspiration see:
                https://beltoforion.de/en/spiral_galaxy_renderer/spiral-galaxy-renderer.html
                https://beltoforion.de/article.php?a=spiral_galaxy_renderer
                https://github.com/beltoforion/Galaxy-Renderer
        [ ] hot planets can be lava / deserts, cold planets can be ice n snow.
            stuff in between can be "normal" (green, water, etc)
        [ ] sand planet with sandworms, like dune.
    [ ] rivers and other terrain features
    [ ] biomes
	[ ] rings around planets (like saturn)
	[...] moons
	    [ ] orbit distance for moons should not have overlapping rings with previous orbit path, spacing needs to include children
            also consider asteroid belts
	[ ] satellites
	[...] wrap planets properly (LOCAL COORDINATE SPACE?)
        https://www.reddit.com/r/gamedev/comments/1gi6np/magic_carpet_style_infinite_wrapping_terrain/
        https://simonschreibt.de/gat/1nsane-carpet-2-repetitive-worlds/
	inspiration and references:
	    Noise-Based RNG: https://www.youtube.com/watch?v=LWFzPP8ZbdU
	    http://www.entropicparticles.com/6-days-of-creation/
	    https://plaxdev.wordpress.com/2017/05/04/procedurally-generating-islands/
	    https://www.reddit.com/search?q=%28perlin|simplex|opensimplex%29+noise&sort=new
	    http://ronvalstar.nl/creating-tileable-noise-maps/ <--looping noise
	    https://www.gamedev.net/blog/33/entry-2138456-seamless-noise/ <--looping noise
	    https://gamedev.stackexchange.com/questions/23625/how-do-you-generate-tileable-perlin-noise <--looping noise
	    http://developworlds.com/blog/2015/05/28/procedural-tilemap-generation/
	    https://flafla2.github.io/2014/08/09/perlinnoise.html
	    http://devmag.org.za/2009/04/25/perlin-noise/
	    http://blog.kaelan.org/randomly-generated-world-map/ <--biome
	    http://freespace.virgin.net/hugo.elias/models/m_perlin.htm
	    OpenSimplex: https://gist.github.com/KdotJPG/b1270127455a94ac5d19
	    new KdotJPG noise!: https://github.com/KdotJPG/New-Simplex-Style-Gradient-Noise

[ ] space stuff
    [ ] various astronomical bodies
        https://en.wikipedia.org/wiki/Astronomical_object#Categories_by_location
	[ ] stars kill on touch (hot!)
	    unless maybe you have an upgraded ship that can handle it?
	[ ] wormhole (teleport)
	    [ ] for now just render a circle
	[ ] blackhole (death)
	    place at center of galaxy
	    https://www.shadertoy.com/results?query=black+hole
	    https://www.shadertoy.com/view/ldy3zK
	    https://www.shadertoy.com/view/ltBGWh
	[ ] dust/noise
	[ ] light specs/debris,details
    [...] galaxy generation inspired by fibonacci spiral
        [...] test screen to generate spiral
        [ ] generate set of points that are concentrated near center, and near arms of spiral
        [ ] implement generation into game
        [ ] make a screen animation


[ ] UI
    [ ] edge map improvement, when entity facing a mapable component (with a few degree wide threshold)
        - make bigger as if focused
        - display distance
    [...] map
        needs more details, select planets and get info, set way points
        [ ] minimap should show heightmap of world when on planet
            (fog of war) start out with grayscale pixelated version, when area visited then render full map and color
    [...] menu menu
        [x] pause / freeze game
        [...] settings and config
    [ ] player manager/inventory/shipbuilder thingy
    [ ] career event timeline stats

[ ] warning when launch
    WARNING: An illegal reflective access operation has occurred
    WARNING: Illegal reflective access by org.lwjgl.LWJGLUtil$3 (file:/home/logica/.gradle/caches/modules-2/files-2.1/org.lwjgl.lwjgl/lwjgl/2.9.3/3df168ac74e4a8c96562cdff24ad352e255bf89c/lwjgl-2.9.3.jar) to method java.lang.ClassLoader.findLibrary(java.lang.String)
    WARNING: Please consider reporting this to the maintainers of org.lwjgl.LWJGLUtil$3
    WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
    WARNING: All illegal access operations will be denied in a future release

[!] untested on 4k or ultra wide, my machines are all 1080p.

[ ] devops n website n legal crap n misc
    [  ] prepare to branch and have a dev stream and "stable stream"
        i need to learn git properly, im lazy just click the button
        https://ohshitgit.com/
    [ ] what are requirements to release on Steam?
        [ ] do I need to trademark / copyright anything?
        [ ] do I need to that ersb rating thingy?
    [?] move to LWJGL 3?
        https://libgdx.com/news/2021/07/devlog-7-lwjgl3
    [ ] move this todo list thingy to a trello or something?
    [ ] need an icon. its still the default libgdx logo...
    [ ] make a page for website spaceproject.xyz or make a github io?
        [ ] dev blog thingy?
    [ ] wiki n documentation
    [ ] should prolly make some unit tests at some point...


[...] config
    [x] config manager, save and load all configs
    [...] config UI
            [OUT_OF_SCOPE] nice way to view and edit configs
                [ ] fix layout
                [ ] hook up load save undo
    [OUT_OF_SCOPE] figure out serialization
        [?] Ships are currently hardcoded by Entity factory
            can we find a way to generate entities from config.
                - consider ranges,
                - consider space vs planet differences (eg: physics)...
                - consider mobile vs desktop? maybe?
            eg:
            Ship {
                SeedComponent{},
                TransformComponent {

                },
                Sprite3DComponent {
                    shipSize = rand range(x,y)
                }
                PhysicsComponent {
                    linearDamping, (when on planet, will be 0 in space)
                    angularDamping (when on planet, will be 0 in space)
                }
                CannonComponent {
                    ammo,
                    damage,
                    fireRate,
                    cannonSize,
                    cannonVelocity,
                },
                HealthComponent {
                    maxHealth
                },
                MapComponent {
                    color,
                    distance
                }
            }

            and what about multi entity groups? eg System
            createPlanetarySystem {
                numPlanets = range(0,10),
                distFromBarycenter = range(0, 10),
                distFromNextEntity = range()
            }

            or in theory allow scripting?
            lets not reinvent this wheel.
            stop brain. this is getting ridiculous.


[ ] DEBUG
    [ ] in game console
        https://github.com/StrongJoshua/libGDX-inGameConsole
        [ ] show debug output
            redirect all gdx.log calls?
        [ ] commands
            eg: /create entity <ship>
                /add component <component> <entitity id>
                /enable/disable system <"system name">
                /setcamfocus <entity>
                /takecontrol <entity> (set control /input focus, if has AI, override (or maybe swap with player would be cool)
                /transfercomponent <component> <entityFrom> <entityTo>
    [x] debug system internals need to go back to old rendering, the new DebugText is horrible on memory.
        i originally did that to make it statically accessible from any system and render properly when called from systems in any priority
        so leave that for external use, just do internals locally
    [...] engine viewer
        [...] arrow navigation and menu expansion
            [x] fix some edge cases on up and down and expansion of empty nodes
            [ ] nothing select, re-select last selected / refocus
            [ ] press and hold up & down
            [ ] page up / down jump to top / bottom
        [ ] aesthetics and usability
            [ ] on key navigation, if selection out of scrollpane view, scroll to make it visible
            [ ] fix arrow expand image on entity node pre/post expand
            [ ] fix scroll bar to show
            [ ] focus on mouse over
        [ ] options
            [ ] poll rate
            [x] toggle history highlighting
            [ ] expand all collapse all
        [...] history (like PE), if added, green for a second. if removed, red for a second
            [ ] systems should get history too, currently only entities working
            [ ] include children
        [x] add count to system and entities node eg: Entities (57), Systems (12)
        [ ] filter for components, bonus points for values (eg: all entities with a health component where component.health > x)
        [ ] possibly a generic reflection object explorer
        [ ] watch window (when node is highlighted, on key or watch button, copy node into its own focused window (including children)
        [ ] field editing
        [ ] add / remove objects
    [ ] FPS,memory,entity graph
        [ ] profiler: https://github.com/libgdx/ashley/pull/215

[ ] optimization
    https://github.com/libgdx/libgdx/wiki/Profiling
    https://github.com/libgdx/libgdx/wiki/Memory-management
    [ ] look at pooled engine/sprites
        [ ] eg bullets. current cannon creates new sprite for each shot. bad!
    [ ] model cache / renderable for 3d sprites
        https://xoppa.github.io/blog/a-simple-card-game/#reduce-the-number-of-render-calls
    [ ] planets are rendered offscreen needlessly -> cull frustum
    [ ] something is funny with the memory, it climbs then resets in a cyclical fashion
        I have a feeling this is a poor use of 'new' somewhere and when the memory resets its the GC cleaning it up
    [ ] fonts should all be in skin, ensure fonts are not duplicated/loaded twice
    http://t-machine.org/index.php/2014/03/08/data-structures-for-entity-systems-contiguous-memory/
    http://unseen-academy.de/snippet_component_system.html
    https://github.com/junkdog/entity-system-benchmarks#entity-system-benchmarks

[...] investigate possible bug in ashley.
    Found 2 weird cases related to families / listeners.
    I would expect all references to a system/family membership to be when a system is removed from the engine.
    This may be intended behavior and I am using ashley wrong, need to reproduce these in a new project to confirm...
    In the context of this game, both occurrences where triggered when going transitioning between space/world which involves loading and unloading specific systems.
    https://github.com/0XDE57/SpaceProject/commit/012bd0bdea4ef5c95b6f8b9454e96a7007d4c7ac
    [A] scenario A:
        1. create engine.
        2. add a new instance of system (SystemA) to engine that subscribes to a family
        3. create a new engine (re-instantiate the original)
        4. add a new instance of system (SystemA) to engine that subscribes to a family.
        5. this new system will not pick up those entities in the family, where it should
        * solution: engine.removeAllEntities(); before re-instantiating engine and system. this resolves the issue.
        Reproduced in ReproFamilyBugTest.class;

    [B] scenario B:
        1. create engine
        2. add a new instance of a system that is an entity listener
        3. remove that system
        4. add a new instance of that system
        5. remove again = crash on System.entityRemoved() when Engine.removeAllEntities():
            Exception in thread "LWJGL Application" java.lang.NullPointerException
            	at com.spaceproject.systems.SpaceLoadingSystem.entityRemoved(SpaceLoadingSystem.java:91)
            	at com.badlogic.ashley.core.FamilyManager.updateFamilyMembership(FamilyManager.java:117)
            	at com.badlogic.ashley.core.Engine.removeEntityInternal(Engine.java:223)
            	at com.badlogic.ashley.core.Engine$EngineEntityListener.entityRemoved(Engine.java:257)
            	at com.badlogic.ashley.core.EntityManager.removeEntityInternal(EntityManager.java:110)
            	at com.badlogic.ashley.core.EntityManager.removeEntity(EntityManager.java:53)
            	at com.badlogic.ashley.core.EntityManager.removeAllEntities(EntityManager.java:72)
            	at com.badlogic.ashley.core.Engine.removeAllEntities(Engine.java:98)
        * Solution: engine.removeEntityListener(the system) when removing system



~~~~~~~~~~~~~~~~~~~~RESOURCES!!!~~~~~~~~~~~~~~~~~~~~
https://github.com/rafaskb/awesome-libgdx#readme

Controller icons! All of the assets are in the public domain under Creative Commons 0 (CC0)
    https://thoseawesomeguys.com/prompts/
Kenney Assets - High quality assets for your game, from 2D and 3D art to sound effects.
    https://kenney.nl/
OpenGameArt.org - Repository offering a variety of open content assets.
    https://opengameart.org/
Game-Icons.net - Repository containing heaps of cool game related graphics.
    https://game-icons.net/
freesound.org - Huge collaborative database of audio snippets, samples, recordings, bleeps.
    https://freesound.org/
fonts
    http://www.fontsquirrel.com/

https://itch.io/game-assets/free/tag-16-bit

https://opensource.org/faq#profit


